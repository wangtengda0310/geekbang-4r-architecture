
业务基本场景
<pre>
app、小程序推送秒杀广告 ----> 用户点击广告浏览秒杀商品信息 ----> 小程序端用户下载app ----> 活动开始秒杀抢购商品 ----> 后台审核 ----> 发货
</pre>

> 20个品类*10个商品 = 已经上线100个商品\
> 秒杀通过前端过滤巨大峰值流量，服务端处理一些攻击行为的异常流量\
> 日活100万假设10%参与秒杀，即10万用户参与秒杀\
> 不能超卖\
> 单机房，不能出现系统不可用\
> 微信小程序可以看到秒杀广告，通过引导下载App参与秒杀活动，假设有10%的用户下载App参与秒杀活动\
> 秒杀提前一周预热\

复杂度分析
- 可扩展性\
支持上架新的秒杀商品 秒杀流量经过客户端随机算法过滤后到达服务器，服务器再将少量请求打散到1~2秒用户可容忍的范围内\
用户浏览秒杀商品读取缓存静态页面\
假设100完用户10%参加秒杀，客户端使用算法过滤1%的流量，即10万个用户中只有1000个用户会真正参与秒杀，两秒时间处理完qps=500
- 高性能、高可用\
多级缓存处理浏览秒杀商品的请求
负载均衡保证秒杀服务的高可用
熔断、限流、降级防止客户端算法失效或者攻击行为
- 安全性\
不能超卖 使用分布式锁实现

#### 总体架构思路
主要通过客户端随机算法屏蔽大量峰值流量，因此tps可以控制在很低的范围，但是用户浏览商品信息和秒杀活动的时候，会有大量的流量，通过缓存处理这些流量。
已有系统已经上架100个商品并支持着100万日活，考虑为秒杀活动单独搭建一套系统，不影响已有系统的正常运行。
#### 存储架构设计
客户端app内缓存, 服务进程内缓存，Redis缓存
#### 计算架构设计
客户端随机算法控制秒杀流量
网关入口根据ip限制重复流量
Redis分布式锁控制最终秒杀到商品的用户
#### 其他架构设计
nginx或者lvs做负载均衡